#!/usr/bin/env python3
# -*- coding: utf-8 -*-
'''
OSINT Module
'''

import os
import configparser
import socket
import pdfkit

from core.config import cfg

CFG = configparser.ConfigParser()
CFG.read('config.ini')

class OsintModule:
    '''Class OsintModule'''
    @staticmethod
    def start_shodan_scan():
        '''Function to start a Shodan scan'''
        print('Starting a Shodan scan on: {} ...'.format(cfg.get().host))
        author = CFG['DEFAULT']['AUTHOR']
        output_dir = os.path.abspath('{}/{}'.format(cfg.get().output_dir, 'WORK'))
        ip_address = socket.gethostbyname(cfg.get().host)
        pdfkit.from_url('https://www.shodan.io/host/{}'
                        .format(ip_address), '{}/Shodan_{}.{}.pdf'
                        .format(output_dir, ip_address, author))
