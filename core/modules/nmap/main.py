#!/usr/bin/env python3
# -*- coding: utf-8 -*-
'''
Nmap module
'''

import os
import configparser

from core.config import cfg

CFG = configparser.ConfigParser()
CFG.read('config.ini')

class NmapModule:
    '''Class NmapModule'''
    @staticmethod
    def fast_scan():
        '''Function to do a fast scan with nmap'''
        output_dir = '{}/{}'.format(cfg.get().output_dir, 'NMAP')
        cmd = CFG['NMAP']['FAST_SCAN_CMD']

        if not os.path.exists(output_dir):
            os.makedirs(output_dir)

        os.system('{} -oA {}/{}-fast-scan.{} {}'
                  .format(cmd, output_dir, cfg.get().host, cfg.get().author, cfg.get().host))

    @staticmethod
    def full_scan():
        '''Function to do a full scan with nmap'''
        output_dir = '{}/{}'.format(cfg.get().output_dir, 'NMAP')
        cmd = CFG['NMAP']['FULL_SCAN_CMD']

        if not os.path.exists(output_dir):
            os.makedirs(output_dir)

        os.system('{} -oA {}/{}-full-scan.{} {}'
                  .format(cmd, output_dir, cfg.get().host, cfg.get().author, cfg.get().host))

    @staticmethod
    def fast_full_scan():
        '''Function to launch both scans'''
        NmapModule.fast_scan()
        NmapModule.full_scan()
